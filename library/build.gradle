apply plugin: 'com.android.library'
apply plugin: 'com.jfrog.bintray'

def Properties localProperties = new Properties()
localProperties.load(project.rootProject.file('local.properties').newDataInputStream())

def versionProperties = new Properties()
versionProperties.load(new FileInputStream('version.properties'))

android {
    compileSdkVersion 25
    buildToolsVersion "25.0.0"

    defaultConfig {
        minSdkVersion 1
        targetSdkVersion 25
        versionCode Integer.parseInt(versionProperties.getProperty('VERSION_CODE'))
        versionName versionProperties.getProperty('VERSION_NAME')
    }

    //noinspection GrUnresolvedAccess
    libraryVariants.all { variant ->
        variant.outputs.each { output ->
            def file = output.outputFile
            //noinspection GroovyAssignabilityCheck,GrUnresolvedAccess
            def fileName = 'alog-' + variant.buildType.name + '-' +
                    defaultConfig.versionName + '-' + defaultConfig.versionCode + '.aar'
            //noinspection GroovyAssignabilityCheck
            output.outputFile = new File(file.parent, fileName)
        }
    }

    return void
}

dependencies {
    testCompile 'junit:junit:4.12'
    testCompile "org.robolectric:robolectric:3.1.2"
}

project.archivesBaseName = 'alog'
group 'ua.pp.ihorzak'
version versionProperties.getProperty('VERSION_NAME')

bintray {
    user = localProperties.getProperty('bintray.user')
    key = localProperties.getProperty('bintray.key')
    pkg {
        repo = 'maven'
        name = 'ALog'
        configurations = ['archives']
    }
}
